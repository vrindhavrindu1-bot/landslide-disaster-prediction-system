<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Landslide Reports</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #333; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h2>Submit a New Report</h2>
  <form id="reportForm">
    <input type="text" name="user" placeholder="User" required>
    <input type="text" name="location" placeholder="Location" required>
    <input type="text" name="observation" placeholder="Observation" required>
    <select name="severity" required>
      <option value="High">High</option>
      <option value="Medium">Medium</option>
      <option value="Low">Low</option>
    </select>
    <button type="submit">Submit Report</button>
  </form>

  <h2>Landslide Reports</h2>
  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>Location</th>
        <th>Observation</th>
        <th>Severity</th>
      </tr>
    </thead>
    <tbody id="reports"></tbody>
  </table>

  
<script>
document.getElementById("reportForm").addEventListener("submit", function(e) {
  e.preventDefault();
  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData.entries());

  fetch("http://127.0.0.1:5000/submit-report", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(result => {
    alert("Report submitted successfully!");
    loadReports(); // refresh table
  })
  .catch(err => console.error("Error submitting report:", err));
});

// Load reports from backend
function loadReports() {
  fetch("http://127.0.0.1:5000/get-reports")
    .then(res => res.json())
    .then(data => {
      const reportEl = document.getElementById("reports");
      reportEl.innerHTML = "";
      data.reports.forEach(report => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${report.user}</td>
          <td>${report.location}</td>
          <td>${report.observation}</td>
          <td style="color:${report.severity.toLowerCase()==="high"?"red":report.severity.toLowerCase()==="medium"?"orange":"green"}">${report.severity}</td>
        `;
        reportEl.appendChild(row);
      });
    })
    .catch(err => console.error("Error loading reports:", err));
}

// Load reports when page opens
window.onload = loadReports;
</script>

